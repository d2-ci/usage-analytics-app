(this["webpackJsonp@dhis2/app-shell"]=this["webpackJsonp@dhis2/app-shell"]||[]).push([[127],{212:function(e,t,a){e.exports={container:"LayoutContainer_container__2gt-1"}},213:function(e,t,a){e.exports={sidebar:"LayoutSidebar_sidebar__38x-X"}},214:function(e,t,a){e.exports={content:"LayoutContent_content__3pEdj"}},215:function(e,t,a){e.exports={title:"AppTitle_title__mjsfQ"}},309:function(e,t,a){e.exports={title:"ChartHeader_title__ff7A2",subtitle:"ChartHeader_subtitle__2JAVZ"}},310:function(e,t,a){e.exports={outerContainer:"ChartWrapper_outerContainer__2BU2T",innerContainer:"ChartWrapper_innerContainer__5ZEsg",chartContainer:"ChartWrapper_chartContainer__jt1gD"}},311:function(e,t,a){},312:function(e,t,a){"use strict";a.r(t);var r=a(7),n=a(1),l=a.n(n),c=a(6),u=a.n(c),s=[{value:"FAVORITE_VIEWS",label:u.a.t("Favorite views"),subtitle:u.a.t("Number of times users looked at analysis favorites")},{value:"FAVORITES_SAVED",label:u.a.t("Favorites saved"),subtitle:u.a.t("Number of analysis favorites created by users")},{value:"USERS",label:u.a.t("Users"),subtitle:u.a.t("Number of users in the system")},{value:"TOP_FAVORITES",label:u.a.t("Top favorites")},{value:"DATA_VALUES",label:u.a.t("Data values"),subtitle:u.a.t("Number of data values saved in the system")}],i=[{value:"DAY",label:u.a.t("Day")},{value:"WEEK",label:u.a.t("Week")},{value:"MONTH",label:u.a.t("Month")},{value:"YEAR",label:u.a.t("Year")}],o=[{value:"SUM",label:u.a.t("Sum")},{value:"AVERAGE",label:u.a.t("Average")}],v=[{value:"ALL",label:u.a.t("All")},{value:"TOTAL",label:u.a.t("Total")}],m=[{value:"CHART_VIEW",label:u.a.t("Chart")},{value:"MAP_VIEW",label:u.a.t("Map")},{value:"REPORT_TABLE_VIEW",label:u.a.t("Report table")},{value:"EVENT_REPORT_VIEW",label:u.a.t("Event report")},{value:"EVENT_CHART_VIEW",label:u.a.t("Event chart")},{value:"DASHBOARD_VIEW",label:u.a.t("Dashboard")},{value:"DATA_SET_REPORT_VIEW",label:u.a.t("Data set report")}],E=[{value:"5",label:"5"},{value:"10",label:"10"},{value:"15",label:"15"},{value:"20",label:"20"},{value:"25",label:"25"}],d=[{value:"ASC",label:u.a.t("Ascending")},{value:"DESC",label:u.a.t("Descending")}],b=a(14),f=a(21),p=a.n(f),y=function(e,t){var a=p()(e,"YYYY-MM-DD"),r=p()(t,"YYYY-MM-DD");return a.isAfter(r)?u.a.t("Start date should be before end date"):""},g=function(e,t){var a=p()(e,"YYYY-MM-DD");return p()(t,"YYYY-MM-DD").isBefore(a)?u.a.t("End date should be after start date"):""},S=function(e){return e?p()(e,"YYYY-MM-DD",!0).isValid()?"":u.a.t("Please use the format yyyy-mm-dd"):u.a.t("Please fill in a date")},D=function(e){var t=e.startDate,a=e.setStartDate,c=e.endDate,s=e.setEndDate,i=e.setIsValid,o=Object(n.useState)(""),v=Object(r.a)(o,2),m=v[0],E=v[1],d=Object(n.useState)(""),f=Object(r.a)(d,2),p=f[0],D=f[1];return l.a.createElement("div",null,l.a.createElement(b.h,{label:u.a.t("Start Date"),type:"date",value:t,error:!!m,validationText:m,onChange:function(e){var t=e.value,r=S(t)||y(t,c);r?(E(r),i(!1)):E("");var n=S(c)||g(t,c);r||n||(D(""),i(!0)),a(t)}}),l.a.createElement(b.h,{label:u.a.t("End Date"),type:"date",value:c,error:!!p,validationText:p,onChange:function(e){var a=e.value,r=S(a)||g(t,a);r?(D(r),i(!1)):D("");var n=S(t)||y(t,a);r||n||(E(""),i(!0)),s(a)}}))},h=function(e){var t=e.interval,a=e.setInterval;return l.a.createElement(b.n,{selected:t,onChange:function(e){var t=e.selected;a(t)},label:u.a.t("Interval")},i.map((function(e){var t=e.label,a=e.value;return l.a.createElement(b.o,{label:t,key:a,value:a})})))},O=function(e){var t=e.aggregation,a=e.setAggregation;return l.a.createElement(b.n,{selected:t,onChange:function(e){var t=e.selected;a(t)},label:u.a.t("Aggregation level")},o.map((function(e){var t=e.label,a=e.value;return l.a.createElement(b.o,{label:t,key:a,value:a})})))},T=function(e){var t=e.chartType,a=e.setChartType;return l.a.createElement(b.n,{selected:t,onChange:function(e){var t=e.selected;a(t)},label:u.a.t("Chart type")},v.map((function(e){var t=e.label,a=e.value;return l.a.createElement(b.o,{label:t,key:a,value:a})})))},A=function(e){var t=e.eventType,a=e.setEventType;return l.a.createElement(b.n,{selected:t,onChange:function(e){var t=e.selected;a(t)},label:u.a.t("Event type")},m.map((function(e){var t=e.label,a=e.value;return l.a.createElement(b.o,{label:t,key:a,value:a})})))},Y=function(e){var t=e.pageSize,a=e.setPageSize;return l.a.createElement(b.n,{selected:t,onChange:function(e){var t=e.selected;a(t)},label:u.a.t("Page size")},E.map((function(e){var t=e.label,a=e.value;return l.a.createElement(b.o,{label:t,key:a,value:a})})))},_=function(e){var t=e.sortOrder,a=e.setSortOrder;return l.a.createElement(b.n,{selected:t,onChange:function(e){var t=e.selected;a(t)},label:u.a.t("Sort order")},d.map((function(e){var t=e.label,a=e.value;return l.a.createElement(b.o,{label:t,key:a,value:a})})))},C=function(e){var t=e.category,a=e.startDate,r=e.setStartDate,n=e.endDate,c=e.setEndDate,u=e.interval,s=e.setInterval,i=e.aggregation,o=e.setAggregation,v=e.chartType,m=e.setChartType,E=e.eventType,d=e.setEventType,b=e.pageSize,f=e.setPageSize,p=e.sortOrder,y=e.setSortOrder,g=e.setIsValid,S="TOP_FAVORITES"===t,C="FAVORITE_VIEWS"===t;return l.a.createElement(l.a.Fragment,null,!S&&l.a.createElement(l.a.Fragment,null,l.a.createElement(D,{startDate:a,setStartDate:r,endDate:n,setEndDate:c,setIsValid:g}),l.a.createElement(h,{interval:u,setInterval:s})),C&&l.a.createElement(l.a.Fragment,null,l.a.createElement(O,{aggregation:i,setAggregation:o}),l.a.createElement(T,{chartType:v,setChartType:m})),S&&l.a.createElement(l.a.Fragment,null,l.a.createElement(A,{eventType:E,setEventType:d}),l.a.createElement(Y,{pageSize:b,setPageSize:f}),l.a.createElement(_,{sortOrder:p,setSortOrder:y})))},V=a(212),j=a.n(V),I=function(e){var t=e.children;return l.a.createElement("main",{className:j.a.container},t)},M=a(213),R=a.n(M),k=function(e){var t=e.children;return l.a.createElement("aside",{className:R.a.sidebar},t)},z=a(214),W=a.n(z),F=function(e){var t=e.children;return l.a.createElement("section",{className:W.a.content},t)},N=function(e){var t=e.category,a=e.setCategory;return l.a.createElement(b.n,{selected:t,onChange:function(e){var t=e.selected;a(t)},label:u.a.t("Category")},s.map((function(e){var t=e.label,a=e.value;return l.a.createElement(b.o,{label:t,key:a,value:a})})))},U=a(215),w=a.n(U),P=function(){return l.a.createElement("h1",{className:w.a.title},u.a.t("Usage Analytics"))},L=a(16),x={favorites:{resource:"dataStatistics/favorites",params:function(e){return{eventType:e.eventType,pageSize:e.pageSize,sortOrder:e.sortOrder}}}},H=function(e){var t=e.eventType,a=e.pageSize,r=e.sortOrder,c=e.children,u=Object(L.c)(x,{lazy:!0,variables:{eventType:t,pageSize:a,sortOrder:r}}),s=u.loading,i=u.error,o=u.data,v=u.called,m=u.refetch;if(Object(n.useEffect)((function(){m({eventType:t,pageSize:a,sortOrder:r})}),[t,a,r]),!v||s)return l.a.createElement(b.e,null,l.a.createElement(b.c,null,l.a.createElement(b.d,null)));if(i)throw i;return c(o.favorites)},B={dataStatistics:{resource:"dataStatistics",params:function(e){return{startDate:e.startDate,endDate:e.endDate,interval:e.interval}}}},J=function(e){var t=e.startDate,a=e.endDate,r=e.interval,c=e.isStale,u=e.setIsStale,s=e.children,i=function(){return u(!1)},o=Object(L.c)(B,{lazy:!0,variables:{startDate:t,endDate:a,interval:r},onComplete:i,onError:i}),v=o.loading,m=o.error,E=o.data,d=o.called,f=o.refetch;if(Object(n.useEffect)((function(){f({startDate:t,endDate:a,interval:r})}),[t,a,r]),!d||v||c)return l.a.createElement(b.e,null,l.a.createElement(b.c,null,l.a.createElement(b.d,null)));if(m)throw m;return s(E.dataStatistics)},K=function(e){var t=e.eventType,a=e.pageSize,r=e.sortOrder;return l.a.createElement(H,{eventType:t,pageSize:a,sortOrder:r},(function(){return null}))},q=function(e,t){var a=e.year,r=e.month,n=e.week,l=e.day;switch(t){case"YEAR":return p()({year:a}).format("YYYY");case"MONTH":var c=r-1;return p()({year:a,month:c}).format("MMM YYYY");case"WEEK":var s="[".concat(u.a.t("Week"),"] [").concat(n,"] / YYYY");return p()({year:a}).format(s);case"DAY":var i=r-1;return p()({year:a,month:i,day:l}).format("MMM D, YYYY")}},Z=function(e){var t=e.children;return l.a.createElement("div",null,l.a.createElement(b.b,null,t))},G=function(e){var t=e.data,a=e.interval;return l.a.createElement(Z,null,l.a.createElement(b.p,null,l.a.createElement(b.t,null,l.a.createElement(b.v,null,l.a.createElement(b.s,null,u.a.t("Date")),l.a.createElement(b.s,null,u.a.t("Data Values")))),l.a.createElement(b.q,null,t.map((function(e){var t=e.year,r=e.month,n=e.week,c=e.day,u=e.savedDataValues,s=q({year:t,month:r,week:n,day:c},a);return l.a.createElement(b.u,{key:s},l.a.createElement(b.r,null,s),l.a.createElement(b.r,null,u))})))))},Q=function(e){var t=e.data,a=e.interval;return l.a.createElement(Z,null,l.a.createElement(b.p,null,l.a.createElement(b.t,null,l.a.createElement(b.v,null,l.a.createElement(b.s,null,u.a.t("Date")),l.a.createElement(b.s,null,u.a.t("Active Users")),l.a.createElement(b.s,null,u.a.t("Total Users")))),l.a.createElement(b.q,null,t.map((function(e){var t=e.year,r=e.month,n=e.week,c=e.day,u=e.activeUsers,s=e.users,i=q({year:t,month:r,week:n,day:c},a);return l.a.createElement(b.u,{key:i},l.a.createElement(b.r,null,i),l.a.createElement(b.r,null,u),l.a.createElement(b.r,null,s))})))))},X=a(195),$=a(309),ee=a.n($),te=function(e){var t=e.title,a=e.subtitle;return l.a.createElement("header",null,l.a.createElement("h4",{className:ee.a.title},t),l.a.createElement("h6",{className:ee.a.subtitle},a))},ae=a(310),re=a.n(ae),ne=function(e){var t=e.children,a=e.title,r=e.subtitle;return l.a.createElement("div",{className:re.a.outerContainer},l.a.createElement(b.b,null,l.a.createElement("div",{className:re.a.innerContainer},l.a.createElement(te,{title:a,subtitle:r}),l.a.createElement("div",{className:re.a.chartContainer},t))))},le=function(e){var t=s.find((function(t){return t.value===e}));return{title:t.label,subtitle:t.subtitle}},ce=function(e,t){return e.map((function(e){var a=e.year,r=e.month,n=e.week,l=e.day;return q({year:a,month:r,week:n,day:l},t)}))},ue={animation:{duration:180},legend:{position:"bottom"},maintainAspectRatio:!1,elements:{line:{tension:0,fill:!1,backgroundColor:"rgba(0, 0, 0, 0)"}},scales:{yAxes:[{scaleLabel:{display:!0,labelString:u.a.t("Values")}}]}},se=function(e){var t=e.data,a=e.category,r=e.interval,n=le(a),c=n.title,s=n.subtitle,i=ce(t,r),o=function(e){return[{label:u.a.t("Active Users"),data:e.map((function(e){return e.activeUsers})),borderColor:"#7cb5ec"},{label:u.a.t("Total Users"),data:e.map((function(e){return e.users})),borderColor:"#cc6600"}]}(t);return l.a.createElement(ne,{title:c,subtitle:s},l.a.createElement(X.a,{data:{labels:i,datasets:o},options:ue}))},ie=function(e){var t=e.data,a=e.category,r=e.interval,n=le(a),c=n.title,s=n.subtitle,i=ce(t,r),o=function(e){return[{label:u.a.t("Data Values"),data:e.map((function(e){return e.savedDataValues})),borderColor:"#7cb5ec"}]}(t);return l.a.createElement(ne,{title:c,subtitle:s},l.a.createElement(X.a,{data:{labels:i,datasets:o},options:ue}))},oe=function(e){var t=e.category,a=e.endDate,r=e.interval,c=e.setIsStale,u=e.isStale,s=e.startDate;return l.a.createElement(J,{startDate:s,endDate:a,interval:r,setIsStale:c,isStale:u},(function(e){switch(t){case"DATA_VALUES":return l.a.createElement(n.Fragment,null,l.a.createElement(ie,{data:e,interval:r,category:t}),l.a.createElement(G,{data:e,interval:r}));case"USERS":return l.a.createElement(n.Fragment,null,l.a.createElement(se,{data:e,interval:r,category:t}),l.a.createElement(Q,{data:e,interval:r}));default:return null}}))},ve=function(e){var t=e.category,a=e.endDate,r=e.eventType,n=e.interval,c=e.isTopFavorites,u=e.pageSize,s=e.setIsStale,i=e.sortOrder,o=e.isStale,v=e.startDate;return e.isValid?c?l.a.createElement(K,{eventType:r,pageSize:u,sortOrder:i}):l.a.createElement(oe,{category:t,startDate:v,endDate:a,interval:n,setIsStale:s,isStale:o}):l.a.createElement(b.e,null,l.a.createElement(b.c,null,l.a.createElement(b.d,null)))},me=(a(311),function(){return{initialStartDate:p()().subtract(4,"months").format("YYYY-MM-DD"),initialEndDate:p()().format("YYYY-MM-DD")}}),Ee=function(){var e=me(),t=e.initialStartDate,a=e.initialEndDate,c=Object(n.useState)("FAVORITE_VIEWS"),u=Object(r.a)(c,2),s=u[0],i=u[1],o=Object(n.useState)(t),v=Object(r.a)(o,2),m=v[0],E=v[1],d=Object(n.useState)(a),b=Object(r.a)(d,2),f=b[0],p=b[1],y=Object(n.useState)("WEEK"),g=Object(r.a)(y,2),S=g[0],D=g[1],h=Object(n.useState)("SUM"),O=Object(r.a)(h,2),T=O[0],A=O[1],Y=Object(n.useState)("ALL"),_=Object(r.a)(Y,2),V=_[0],j=_[1],M=Object(n.useState)("CHART_VIEW"),R=Object(r.a)(M,2),z=R[0],W=R[1],U=Object(n.useState)("25"),w=Object(r.a)(U,2),L=w[0],x=w[1],H=Object(n.useState)("ASC"),B=Object(r.a)(H,2),J=B[0],K=B[1],q=Object(n.useState)(!1),Z=Object(r.a)(q,2),G=Z[0],Q=Z[1],X=Object(n.useState)(!0),$=Object(r.a)(X,2),ee=$[0],te=$[1],ae="TOP_FAVORITES"===s;return l.a.createElement(I,null,l.a.createElement(k,null,l.a.createElement(P,null),l.a.createElement(N,{category:s,setCategory:i}),l.a.createElement(C,{aggregation:T,category:s,chartType:V,endDate:f,eventType:z,interval:S,pageSize:L,setAggregation:A,setChartType:j,setEndDate:p,setEventType:W,setInterval:function(e){Q(!0),D(e)},setPageSize:x,setSortOrder:K,setStartDate:E,sortOrder:J,startDate:m,setIsValid:te})),l.a.createElement(F,null,l.a.createElement(ve,{category:s,endDate:f,eventType:z,interval:S,isTopFavorites:ae,pageSize:L,setIsStale:Q,sortOrder:J,isStale:G,startDate:m,isValid:ee})))};a.d(t,"default",(function(){return Ee}))}}]);
//# sourceMappingURL=app.1d591416.chunk.js.map